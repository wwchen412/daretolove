<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- fb OG -->
    <meta property="og:url" content="https://kkl.daretolove.tw/" />
    <meta property="og:type" content="video.movie" />
    <meta property="og:title" content="劇照下載｜Dare to Love 勇敢愛 我的心情我的酒" />
    <meta property="og:description" content="如果能夠重來一次，你還會選擇離開嗎？" />
    <meta property="og:image" content="https://kkl.daretolove.tw/content/img/fbcover.png" />
    <meta property="og:image:width" content="800" />
    <meta property="fb:app_id" content="288053411702507">
    <title>劇照下載｜Dare to Love 勇敢愛 我的心情我的酒</title>
    <link rel="stylesheet" href="content/css/main.css">
    <link rel="stylesheet" href="content/css/wine.css?t=103">
    <link rel="shortcut icon" type="image/x-icon" href="/content/img/favicon.png" />


    <!-- font -->
    <script src="https://use.typekit.net/wnv0scu.js"></script>
    <script>
        try {
            Typekit.load({
                async: true
            });
        } catch (e) {}

    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115377158-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'UA-115377158-1');

    </script>
</head>

<body>
    <script>
        window.fbAsyncInit = function() {
            FB.init({
                appId: '288053411702507',
                xfbml: true,
                cookie: false,
                version: 'v2.5'
            });
        };
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {
                return;
            }
            js = d.createElement(s);
            js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

    </script>

    <div id="wrap">

        <!-- header -->
        <div class="row no-gutters">
            <div class="col-12">
                <header>
                    <div class="nav-bar">
                        <nav class="container d-md-flex ">
                            <div class="nav-item mr-md-auto d-flex d-md-block justify-content-between p-md-0 p-2">
                                <a href="/" class="d-inline-block p-2 text-light">
                                <img src="content/img/title.png" alt="" style="width: 150px;" >
                            </a>
                                <a class="d-inline-block d-md-none p-2 text-light" id="menu">
                                <img src="content/img/menu.svg" alt="" width="30px">
                            </a>
                            </div>
                            <ul class="nav nav-stacked flex-column flex-md-row text-right text-md-center">
                                <li class="nav-item">
                                    <a href="index.html" class="d-block p-2 active">首頁</a>
                                </li>
                                <li class="nav-item">
                                    <a href="video.html" class="d-block p-2">線上單元劇</a>
                                </li>
                                <li class="nav-item">
                                    <a href="gallery.html" class="d-block p-2">劇照下載</a>
                                </li>
                                <li class="nav-item">
                                    <a href="wine.html" class="d-block p-2">心情酒譜</a>
                                </li>
                                <li class="nav-item">
                                    <a href="music.html" class="d-block p-2">主題曲</a>
                                </li>
                            </ul>
                        </nav>
                    </div>

                    <div class="container position-relative">

                        <div class="title position-absolute">
                            <img src="/content/img/maintitle.svg" alt="" class="filterTitle">
                        </div>
                    </div>

                    <div class="heroImg">
                        <img src="content/img/G_bg.jpg" alt="" class="img-fluid d-none d-md-block">
                        <img src="content/img/G_bg_m.png" alt="" class="img-fluid d-block d-md-none">
                    </div>
                </header>
            </div>

        </div>

        <!-- 劇照 -->
        <div class="photography">
            <div class="container">
                <div class="section-title">
                    <h3 class="text-center">劇照下載</h3>
                </div>

                <ul class="d-md-flex list-unstyled flex-wrap dramaPics" id="dramapics">

                </ul>
            </div>
        </div>

        <!-- 活動 -->
        <!-- <div class="event bgmain">
            <div class="container">
                <div class="section-title">
                    <h3 class="text-center">Event</h3>
                </div>
                <div class="row">
                    <div class="col-md-10 offset-md-1 mt-md-5">
                        <img src="content/img/event.png" alt="" class="img-fluid">
                        <p class="py-3">分享你的愛情故事照片，選擇你當下的心情與劇中出現的金門高粱酒調酒並且對照片寫下當時的心得，並分享至你的臉書塗鴉牆。</p>
                    </div>
                    <div class="col-12 text-center my-3">
                        <button type="button" name="" id="" class="btn btn-danger m-auto px-5 rounded-0">
                            前往活動
                        </button>
                    </div>
                </div>
            </div>
        </div> -->


        <footer class="text-center">
            <a href="http://www.kkl.com.tw/" target="_blank">
                <img src="content/img/logo.svg?2" alt=""></a>
            <p class="text-secondary py-sm-3" style="font-size: 12px;">金門酒廠實業股份有限公司版權所有<br>Copyright © Kinmen Kaoliang Liquor Inc. All Rights Reserved.</p>

        </footer>
        <!-- Modal -->
        <div class="modal fade" id="picModal" tabindex="-1" role="dialog" aria-labelledby="picModalTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content  border-0" style="background:transparent">
                    <div class="modal-header border-0 p-3">
                        <!-- <h5 class="modal-title text-light" id="exampleModalLongTitle">Modal title</h5> -->
                        <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <img src="content/img/pics/RB1_1676.jpg" alt="" class="img-fluid">
                    </div>
                    <div class="modal-footer border-0">
                        <a href="" class="downloadImg" download>
                            <img src="content/img/download.svg" alt="">
                        </a>

                        <a href="" class="shareBtn">
                            <img src="content/img/share.svg" alt="">
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="movieModal" tabindex="-1" role="dialog" aria-labelledby="movieModalTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content  border-0" style="background:transparent">
                    <div class="modal-header border-0 p-3">
                        <!-- <h5 class="modal-title text-light" id="exampleModalLongTitle">Modal title</h5> -->
                        <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe width="560" height="315" src="https://www.youtube.com/embed/K0-hweW2LaY?rel=0&amp;controls=0&amp;showinfo=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                        </div>
                    </div>
                    <div class="modal-footer border-0">
                        <a href="" class="shareBtn">
                            <img src="content/img/share.svg" alt="">
                        </a>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- 標語 -->
    <div class="position-fixed signgal p-1">
        <img src="content/img/footer_fixed_font.svg?2" alt="" class="img-fluid">
    </div>
    <!-- jQuery JS 1.12.4 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="script/bootstrap.min.js"></script>
    <script src="script/bootstrap.bundle.min.js"></script>
    <script src="script/APlayer.min.js"></script>
    <script src="script/jquery.cookie.js"></script>
    <script src="script/all.js?t=99"></script>

    <script type="text/javascript">
        $(function() {


            // 點劇照換照片
            renewImg();

            function renewImg() {
                console.log('renew');
                $('.dramaPics li a').each(function() {
                    $(this).click(function() {
                        event.preventDefault();
                        var imgSrc = $(this).find('img').attr('src');

                        $('#picModal .modal-body img').attr('src', imgSrc);
                        var downloadLink = imgSrc.replace('.jpg', '_ori.jpg');
                        console.log(downloadLink);
                        $('#picModal .downloadImg').attr('href', downloadLink);
                    })

                })
                var userAgent, ieReg, ie;
            userAgent = window.navigator.userAgent;
            ieReg = /msie|Trident.*rv[ :]*11\./gi;
            ie = ieReg.test(userAgent);

            if (ie) {
                $(".dramaPics li").each(function () {
                    var $container = $(this),
                        imgUrl = $container.find("img").prop("src");
                    if (imgUrl) {
                        $container.css("backgroundImage", 'url(' + imgUrl + ')').addClass("custom-object-fit");
                    }
                });
            }

            }



            // fb分享
            $('body').on('click', '.shareBtn', function() {
                event.preventDefault();
                var image = $(this).parents().find('.modal-body img').attr('src');
                // console.log(image);
                FB.ui({
                    method: 'share_open_graph',
                    mobile_iframe: true,
                    action_type: 'og.shares',
                    action_properties: JSON.stringify({
                        object: {
                            'og:url': 'http://kkl.daretolove.tw/#movie', // your url to share
                            'og:title': 'Dare to love',
                            'og:description': '我的心情我的酒',
                            'og:image:url': image,
                            'og:image:width': '1920',
                            'og:image:height': '1200',
                        }
                    }),
                    href: 'http://kkl.daretolove.tw/#movie',

                }, function(response) {
                    alert('分享完成！')
                });
            })


            // movie光箱展開
            var $location = window.location.href;
            var $locationArray = $location.split('/');
            var lastHash = $locationArray[$locationArray.length - 1];
            console.log(lastHash);
            if (lastHash == '#movie') {
                $("#movieModal").modal('show');
            }

            $("#movieModal").on('hidden.bs.modal', function(e) {
                $("#movieModal iframe").attr("src", $("#movieModal iframe").attr("src"));
            });


            // ajax load imgs
            // 取得劇照資料
            $.ajax({
                url: "https://kkl.daretolove.tw/img.json"
            }).done(function(res) {
                console.log(res.imgs);
                // 新增內容  數量 偵測用的容器高
                var content = "",
                    counter = 8,
                    wrapper = document.getElementById('dramapics');

                // 先讀出前面9個並新增到ul中
                for (var i = 0; i < counter; i++) {

                    content += "<li class='fadeIn'>";
                    content += "<a href='' data-toggle='modal' data-target='#picModal'>";
                    content += "<img class='img - fluid' src='" + res.imgs[i].img + "' alt=''>";
                    content += "</a>";
                    content += "</li>";
                    $('.dramaPics').html(content);
                }


                // 當滾輪滑動時執行事件
                window.addEventListener("scroll", function() {

                    var contentHeight = wrapper.offsetHeight + wrapper.offsetTop,
                        currentScrollPosition = window.pageYOffset,
                        actualScrolledHeight = currentScrollPosition + window.innerHeight,
                        appendContent = "";

                    // 如果物件底部高於捲軸執行事件
                    if (actualScrolledHeight >= contentHeight && counter < res.imgs.length) {
                        // 擷取現在已經渲染的數樣 到新的數量

                        var resSlice = res.imgs.slice(counter, counter + 3);

                        for (var i = 0; i < 3; i++) {

                            appendContent += "<li class='fadeIn'>";
                            appendContent += "<a href='' data-toggle='modal' data-target='#picModal'>";
                            appendContent += "<img class='img - fluid' src='" + resSlice[i].img + "' alt=''>";
                            appendContent += "</a>";
                            appendContent += "</li>";

                        }
                        counter = counter + i;

                        $('.dramaPics').append(appendContent);
                    }
                    renewImg();
                });

            }).fail(function(err) {
                console.log(err);
            });
            
        })

    </script>


</body>

</html>
